# Aegis Linux - ClamAV Freshclam Configuration
# =============================================================================
# Automatic signature database updates
# =============================================================================

# Database directory (must match clamd.conf)
DatabaseDirectory /var/lib/clamav

# Update log
UpdateLogFile /var/log/clamav/freshclam.log
LogFileMaxSize 2M
LogTime yes
LogSyslog yes
LogRotate yes

# Database mirrors
DatabaseMirror database.clamav.net

# Number of update checks per day (every 2 hours)
Checks 12

# Use DNS for database version check
DNSDatabaseInfo current.cvd.clamav.net

# Script to run after successful update
# OnUpdateExecute /usr/local/bin/aegis-clamav-notify

# Script to run on database update error
# OnErrorExecute /usr/local/bin/aegis-clamav-error

# Script to run on outdated database warning
# OnOutdatedExecute /usr/local/bin/aegis-clamav-outdated

# Connection settings
ConnectTimeout 30
ReceiveTimeout 60

# Test databases before replacing
TestDatabases yes

# Bytecode signature support
Bytecode yes

# Use SafeMode (prevents symlink attacks)
SafeBrowsing yes

# Compression for downloads
CompressLocalDatabase no

# Extra databases (unofficial signatures)
# These are managed by clamav-unofficial-sigs or fangfrisch
# ExtraDatabase /var/lib/clamav/sanesecurity.ftm
# ExtraDatabase /var/lib/clamav/securiteinfo.hdb
