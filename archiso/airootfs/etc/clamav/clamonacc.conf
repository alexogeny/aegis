# Aegis Linux - ClamAV On-Access Scanner Configuration
# =============================================================================
# Real-time file access monitoring using fanotify
# =============================================================================

# Log file
LogFile /var/log/clamav/clamonacc.log
LogTime yes
LogVerbose yes

# Socket to connect to clamd
LocalSocket /run/clamav/clamd.ctl

# Paths to watch for file access
OnAccessMountPath /home
OnAccessMountPath /tmp
OnAccessMountPath /var/tmp

# Prevention mode - deny access to infected files
OnAccessPrevention yes

# Perform extra scanning when files are created/modified
OnAccessExtraScanning yes

# Exclude paths (high I/O, system directories)
OnAccessExcludePath /proc
OnAccessExcludePath /sys
OnAccessExcludePath /dev
OnAccessExcludePath /run
OnAccessExcludePath /var/cache
OnAccessExcludePath /var/lib/docker
OnAccessExcludePath /var/lib/clamav
OnAccessExcludePath /home/*/.cache
OnAccessExcludePath /home/*/.local/share/Trash

# Exclude users
OnAccessExcludeUname clamav
OnAccessExcludeUname root

# Maximum file size to scan in on-access mode
OnAccessMaxFileSize 25M

# Retry attempts on transient errors
OnAccessRetryAttempts 3

# Deny on error (safer but may block legitimate access)
OnAccessDenyOnError no

# Disable DDD (dangerous - disables all on-access)
# OnAccessDisableDDD no
