# Aegis Linux - Audit Daemon Configuration
# =============================================================================

# Log file location
log_file = /var/log/audit/audit.log

# Write logs to disk immediately
write_logs = yes
log_format = ENRICHED
log_group = root

# Maximum log file size (MB)
max_log_file = 50

# Number of log files to keep
num_logs = 10

# What to do when max_log_file is reached
# ROTATE, IGNORE, SYSLOG, SUSPEND, KEEP_LOGS
max_log_file_action = ROTATE

# Space left threshold for warnings (MB)
space_left = 75
space_left_action = SYSLOG

# Action when admin space runs low
admin_space_left = 50
admin_space_left_action = SUSPEND

# Action when disk is full
disk_full_action = SUSPEND
disk_error_action = SUSPEND

# Flush mode: none, incremental, incremental_async, data, sync
flush = INCREMENTAL_ASYNC

# Frequency for incremental flush
freq = 50

# Local events
local_events = yes

# Dispatcher program
dispatcher = /sbin/audispd

# Name format for network dispatch
name_format = HOSTNAME

# Priority boost
priority_boost = 4

# TCP listen options (disabled by default for security)
tcp_listen_queue = 5
tcp_max_per_addr = 1
tcp_client_max_idle = 0
